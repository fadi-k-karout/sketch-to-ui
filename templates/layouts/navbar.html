{{define "navbar"}}
<nav id="navbar" class="navbar bg-base-100">
  <div class="flex-1">
    <a href="/" class="btn btn-ghost text-xl">Sketch to UI</a>
  </div>
  <label class="swap swap-rotate">
    <!-- this hidden checkbox controls the state -->
    <input type="checkbox" class="theme-controller" value="dark" />

    <!-- sun icon -->
    <span
      class="swap-off iconify text-4xl"
      data-icon="material-symbols:light-mode-outline-rounded"
    ></span>

    <!-- moon icon -->
    <span class="swap-on iconify text-4xl" data-icon="tdesign:mode-dark"></span>
  </label>
  <div class="flex-none gap-2">
    {{ if .isLoggedIn }}
    <div class="dropdown dropdown-end">
      <div
        tabindex="0"
        role="button"
        class="flex items-center space-x-2 p-2 rounded-lg hover:bg-base-200 cursor-pointer"
      >
        <div class="avatar">
          <div class="w-10 h-10 rounded-full">
            <img src="{{ .avatarPath }}" alt="avatar" />
          </div>
        </div>
        <div class="text-sm">
          <div class="font-semibold text-base-content">
            {{.firstName}} {{.lastName}}
          </div>
          <div class="text-xs text-base-content/60">Product Designer</div>
        </div>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 ml-1"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            fill-rule="evenodd"
            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd"
          />
        </svg>
      </div>

      <ul
        tabindex="0"
        class="mt-3 z-[1] p-2 shadow menu menu-sm dropdown-content bg-base-100 rounded-box w-52"
      >
        <li>
          <a hx-get="/sketchpad" hx-target="#content">Sketchpad</a>
        </li>
        <li>
          <a class="justify-between">
            Profile
            <span class="badge">New</span>
          </a>
        </li>
        <li><a>Settings</a></li>
        <li><a hx-get="/logout" hx-target="#content">Logout</a></li>
      </ul>
    </div>
    {{ else }}
    <ul class="menu menu-horizontal px-1">
      <li>
        <a hx-get="/login" hx-target="#content" class="btn btn-ghost">Login</a>
      </li>
      <li>
        <a hx-get="/signup" hx-target="#content" class="btn btn-ghost"
          >Signup</a
        >
      </li>
    </ul>
    {{ end }}
  </div>
</nav>
<script>
  document.body.addEventListener("htmx:afterOnLoad", function (evt) {
    if (evt.detail.xhr.getResponseHeader("HX-Trigger") === "navbarChanged") {
      htmx.ajax("GET", "/navbar", {
        target: "#navbar",
        swap: "outerHTML",
        pushURL: false,
      });
    }
  });
</script>
{{end}}
